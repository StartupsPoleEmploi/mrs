@import conf.WebAppConfig
@import controllers.recruteur.RechercheCandidatForm
@import fr.poleemploi.perspectives.authentification.domain.RecruteurAuthentifie
@import fr.poleemploi.perspectives.commun.domain.{Departement, SecteurActivite}
@import fr.poleemploi.perspectives.projections.candidat.ResultatRechercheCandidat
@import helper._

@(rechercheCandidatForm: Form[RechercheCandidatForm],
        secteursActivites: List[SecteurActivite],
        departements: List[Departement],
        recruteurAuthentifie: RecruteurAuthentifie,
        resultatRechercheCandidat: ResultatRechercheCandidat)(implicit request: MessagesRequestHeader, flash: Flash, assetsFinder: AssetsFinder, webAppConfig: WebAppConfig)

@layout(recruteurAuthentifie = Some(recruteurAuthentifie)) {
    <div id="rechercheCandidat">
        <section class="compteurResultats">
            <h2 class="compteurResultats-titre"></h2>
        </section>
        <div id="js-modaleVideo" class="modal" tabindex="-1" role="dialog" aria-labelledby="titreModaleVideo">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modaleVideo-header">
                        <h3 class="modaleVideo-titre" id="titreModaleVideo">La méthode de recrutement par simulation</h3>
                        <span class="modaleVideo-fermer" data-dismiss="modal">&times;</span>
                    </div>
                    <div class="modaleVideo-body">
                        <iframe id="js-videoMRSYoutube" style="position:absolute;width:100%;height:100%;left:0" width="640" height="360" frameborder="0" allow="autoplay; encrypted-media">
                        </iframe>
                    </div>
                </div>
            </div>
        </div>
        <section class="criteresRecherche">
            @form(action = controllers.recruteur.routes.RechercheCandidatController.rechercherCandidats(), 'id -> "criteresRechercheForm") {
                @CSRF.formField
                <div class="criteres">
                    <div class="criteres-item conteneurSelecteur">
                        <label for="js-secteursActivites-selecteur" class="conteneurSelecteur-label">Choisissez un secteur d'activité</label>
                        <select id="js-secteursActivites-selecteur" class="conteneurSelecteur-selecteur" name="secteurActivite">
                            <option value="">Tous les secteurs</option>
                            @for(secteurActivite <- secteursActivites) {
                                <option value="@secteurActivite.code.value">@secteurActivite.label</option>
                            }
                        </select>
                    </div>
                    <div class="criteres-item conteneurSelecteur">
                        <label for="js-metiers-selecteur" class="conteneurSelecteur-label">Chosissez un métier</label>
                        <select id="js-metiers-selecteur" class="conteneurSelecteur-selecteur" name="metier">
                            <option value="">Tous les métiers</option>
                            @for(metier <- secteursActivites.flatMap(_.metiers)) {
                                <option value="@metier.codeROME.value">@metier.label</option>
                            }
                        </select>
                    </div>
                    <div class="criteres-item conteneurSelecteur">
                        <label for="js-departements-selecteur" class="conteneurSelecteur-label">Choisissez un département</label>
                        <select id="js-departements-selecteur" class="conteneurSelecteur-selecteur" name="codeDepartement">
                        @for(departement <- departements) {
                            <option value="@departement.code">@departement.label</option>
                        }
                        </select>
                    </div>
                    <div class="videoMRS">
                        <a id="js-infoBulleMRS" class="infoBulleMRS" href="#" data-toggle="modal" data-target="#js-modaleVideo">
                            <img class="infoBulleMRS-iconeLecture" alt="Lecture vidéo MRS" width="36" height="36"
                                 src="@assetsFinder.path("images/pages/recruteur/rechercheCandidat/lecture-video.svg")" />
                            <div class="questionMRS">Qu'est ce qu'une MRS?</div>
                        </a>
                        <img class="definitionMRS" alt="Definition MRS" width="56" height="56"
                             src="@assetsFinder.path("images/pages/recruteur/rechercheCandidat/mrs.svg")" />
                    </div>
                </div>
            }
        </section>
        <section id="js-resultatsRecherche" class="resultatsRecherche">
            @partials.resultatsRecherche(resultatRechercheCandidat)
        </section>
        <pagination ref="pagination"
                    v:bind:nb-par-page="nbCandidatsParPage"
                    v-on:charger-page-suivante="chargerPageSuivante"
                    v-on:charger-page-precedente="chargerPagePrecedente"
                    v-bind:pages-initiales="pagesInitiales"></pagination>
        <section class="commentaireRecruteur-arrierePlan">
            <div class="commentaireRecruteur" id="commenterListeCandidats">
                <h2 class="commentaireRecruteur-titre" id="js-titreCommentaireRecruteur">Êtes-vous satisfait(e) de cette liste de candidats ?</h2>
                <div class="commentaireRecruteur-actions" id="js-commentaireActions">
                    <a href="#commenterListeCandidats" id="js-satisfait"
                        class="commentaireRecruteur-action bouton bouton--noir">
                        Oui
                    </a>
                    <a href="#commenterListeCandidats" id="js-insatisfait"
                        class="commentaireRecruteur-action bouton bouton--noir">
                        Non
                    </a>
                </div>
                @form(action = controllers.recruteur.routes.RechercheCandidatController.commenterListeCandidats(),
                    'id -> "commentaireListeCandidatsForm",
                    'class -> "commentaireRecruteur-formulaire") {
                    @CSRF.formField
                    <input type="hidden" name="secteurActiviteRecherche" id="js-commentaireSecteurActivite" value=""/>
                    <input type="hidden" name="metierRecherche" id="js-commentaireMetier" value=""/>
                    <input type="hidden" name="departementRecherche" id="js-commentaireDepartement" value=""/>
                    <label id="js-labelCommentaireRecruteur" for="commentaireRecruteur" class="commentaireRecruteur-label"></label>
                    <textarea id="commentaireRecruteur" name="commentaire" class="zoneTexte" rows="6" cols="50" required maxlength="300"></textarea>
                    <div class="envoyerCommentaire">
                        <button id="js-envoyerCommentaire" class="envoyerCommentaire-bouton bouton bouton--fondBleu">Envoyer</button>
                    </div>
                }
            </div>
        </section>
    </div>

    <script src="@assetsFinder.path("javascripts/modules/pagination.js")" type="text/javascript"></script>
    <script src="@assetsFinder.path("javascripts/pages/recruteur/rechercheCandidat.js")" type="text/javascript"></script>
}