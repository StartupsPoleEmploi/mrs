@import conf.WebAppConfig
@import controllers.recruteur.MatchingForm
@import fr.poleemploi.perspectives.authentification.domain.RecruteurAuthentifie
@import fr.poleemploi.perspectives.commun.domain.{Departement, SecteurActivite}
@import fr.poleemploi.perspectives.projections.candidat.ResultatRechercheCandidat
@import helper._

@(matchingForm: Form[MatchingForm],
        secteursActivites: List[SecteurActivite],
        departements: List[Departement],
        recruteurAuthentifie: RecruteurAuthentifie,
        resultatRechercheCandidat: ResultatRechercheCandidat)(implicit request: MessagesRequestHeader, flash: Flash, assetsFinder: AssetsFinder, webAppConfig: WebAppConfig)

@layout(recruteurAuthentifie = Some(recruteurAuthentifie)) {
    <div id="matchingCandidats">
        <section class="compteurResultats"> @** Utilisation de if car si on fait du pattern matching twirl generent des lignes inutiles et le bloc prend alors plus de place sur l'écran... *@
            @if(resultatRechercheCandidat.nbCandidats == 0) {
                <h2 class="compteurResultats-titre">Nous n'avons pas de candidats à vous proposer</h2>
            }
            @if(resultatRechercheCandidat.nbCandidats == 1) {
                <h2 class="compteurResultats-titre"><b>1 candidat perspectives</b>
                    est validé par la Méthode de Recrutement par Simulation</h2>
            }
            @if(resultatRechercheCandidat.nbCandidats > 1) {
                <h2 class="compteurResultats-titre"><b>@resultatRechercheCandidat.nbCandidats candidats perspectives</b>
                    sont validés par la Méthode de Recrutement par Simulation</h2>
            }
        </section>
        <div id="js-modaleVideo" class="modal" tabindex="-1">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modaleVideo-header">
                        <h3 class="modaleVideo-titre">La méthode de recrutement par simulation</h3>
                        <span class="modaleVideo-fermer" data-dismiss="modal">&times;</span>
                    </div>
                    <div class="modaleVideo-body">
                        <iframe id="js-videoMRSYoutube" style="position:absolute;width:100%;height:100%;left:0" width="640" height="360" frameborder="0" allow="autoplay; encrypted-media">
                        </iframe>
                    </div>
                </div>
            </div>
        </div>
        <section class="criteresRecherche">
            @form(action = controllers.recruteur.routes.MatchingController.rechercherCandidats(), 'id -> "criteresRechercheForm") {
                @CSRF.formField
                <div class="criteres">
                    <div class="criteres-item conteneurSelecteur">
                        <label for="js-secteursActivites-selecteur" class="conteneurSelecteur-label">Choisissez un secteur d'activité</label>
                        <select id="js-secteursActivites-selecteur" class="conteneurSelecteur-selecteur" name="secteurActivite">
                            <option value="">Tous les secteurs</option>
                            @for(secteurActivite <- secteursActivites) {
                                <option value="@secteurActivite.code.value">@secteurActivite.label</option>
                            }
                        </select>
                    </div>
                    <div class="criteres-item conteneurSelecteur">
                        <label for="js-metiers-selecteur" class="conteneurSelecteur-label">Chosissez un métier</label>
                        <select id="js-metiers-selecteur" class="conteneurSelecteur-selecteur" name="metier">
                            <option value="">Tous les métiers</option>
                            @for(metier <- secteursActivites.flatMap(_.metiers)) {
                                <option value="@metier.codeROME.value">@metier.label</option>
                            }
                        </select>
                    </div>
                    <div class="criteres-item  conteneurSelecteur">
                        <label for="js-departements-selecteur" class="conteneurSelecteur-label">Choisissez un département</label>
                        <select id="js-departements-selecteur" class="conteneurSelecteur-selecteur" name="codeDepartement">
                        @for(departement <- departements) {
                            <option value="@departement.code">@departement.label</option>
                        }
                        </select>
                    </div>
                    <div class="videoMRS">
                        <a id="js-infoBulleMRS" class="infoBulleMRS" href="#" data-toggle="modal" data-target="#js-modaleVideo">
                            <img class="infoBulleMRS-iconeLecture" alt="Lecture vidéo MRS" width="36" height="36"
                            src="@assetsFinder.path("images/pages/recruteur/matching/lecture-video.svg")" />
                            <div class="questions">
                                <span class="questionMRS">Une MRS?</span>
                                <span>Qu'est ce que c'est?</span>
                            </div>
                        </a>
                        <img class="definitionMRS" alt="Definition MRS" width="56" height="56"
                        src="@assetsFinder.path("images/pages/recruteur/matching/mrs.svg")" />
                    </div>
                </div>
            }
        </section>
        <section id="js-resultatsRecherche" class="resultatsRecherche">
            @partials.resultatsRecherche(resultatRechercheCandidat)
        </section>
    </div>
    <script src="@assetsFinder.path("javascripts/pages/recruteur/matching.js")" type="text/javascript"></script>
}